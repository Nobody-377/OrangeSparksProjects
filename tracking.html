<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
<style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
      background-color: #f8fafc;
    }

    * {
      box-sizing: border-box;
    }

    .app-wrapper {
      width: 100%;
      height: 100%;
      overflow-y: auto;
    }

    .header {
      background-color: white;
      border-bottom: 1px solid #e5e7eb;
      padding: 16px 24px;
    }

    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo-section {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo {
      width: 40px;
      height: 40px;
      background-color: #3b82f6;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .company-name {
      font-size: 25px;
      font-weight: 700;
      margin: 0;
      color: #1e293b;
    }

    @media (max-width: 768px) {
      .company-name {
        display: none;
      }
    }

    .nav-links {
      display: flex;
      gap: 24px;
    }

    .nav-btn {
      background: none;
      border: none;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      padding: 8px 12px;
      border-radius: 6px;
      transition: all 0.2s;
      color: #1e293b;
      text-decoration: none;
    }

    .nav-btn:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }

    .nav-btn.active {
      font-weight: 600;
      color: #3b82f6;
    }

    .main-content {
      width: 100%;
      min-height: calc(100% - 73px);
      padding: 48px 24px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .container-small {
      max-width: 480px;
      margin: 0 auto;
    }

    .stat-card {
      background: white;
      padding: 48px;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .tracking-detail {
      background: white;
      border-radius: 16px;
      padding: 48px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .form-group {
      margin-bottom: 24px;
    }

    .form-label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #1e293b;
    }

    .form-input {
      width: 100%;
      padding: 14px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-size: 16px;
      transition: all 0.2s;
    }

    .form-input:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .btn-primary {
      width: 100%;
      background-color: #3b82f6;
      color: white;
      padding: 16px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 700;
      border: none;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-primary:hover {
      background-color: #2563eb;
      transform: translateY(-2px);
    }

    .back-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      background: none;
      border: none;
      color: #3b82f6;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      margin-bottom: 24px;
      padding: 0;
      text-decoration: none;
    }

    .back-btn:hover {
      text-decoration: underline;
    }

    .status-badge {
      padding: 8px 20px;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
    }

    .detail-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 24px;
      margin: 32px 0;
    }

    .detail-label {
      font-size: 12px;
      color: #64748b;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 4px;
    }

    .detail-value {
      font-size: 18px;
      font-weight: 600;
      color: #1e293b;
    }

    .progress-bar {
      width: 100%;
      height: 12px;
      background-color: #e5e7eb;
      border-radius: 999px;
      overflow: hidden;
      margin: 32px 0;
    }

    .progress-fill {
      height: 100%;
      border-radius: 999px;
    }

    .timeline {
      margin-top: 32px;
    }

    .timeline-item {
      display: flex;
      gap: 24px;
      margin-bottom: 40px;
    }

    .timeline-item:last-child {
      margin-bottom: 0;
    }

    .timeline-dot {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      position: relative;
    }

    .timeline-dot::after {
      content: '';
      position: absolute;
      left: 50%;
      top: 100%;
      width: 2px;
      height: 40px;
      background: #e5e7eb;
      transform: translateX(-50%);
    }

    .timeline-item:last-child .timeline-dot::after {
      display: none;
    }

    .timeline-content {
      flex: 1;
      padding-bottom: 8px;
    }

    .timeline-status {
      font-size: 16px;
      font-weight: 600;
      margin: 0 0 4px 0;
    }

    .timeline-location {
      font-size: 14px;
      color: #64748b;
      margin: 0 0 2px 0;
    }

    .timeline-date {
      font-size: 12px;
      color: #64748b;
      margin: 0;
    }

    .shipments-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 24px;
    }

    .shipment-card {
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      cursor: pointer;
      transition: transform 0.2s;
      text-decoration: none;
      color: inherit;
      display: block;
    }

    .shipment-card:hover {
      transform: translateY(-4px);
    }

    .shipment-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 16px;
    }

    .shipment-id {
      font-size: 18px;
      font-weight: 700;
      margin: 0 0 4px 0;
      color: #1e293b;
    }

    .shipment-route {
      font-size: 14px;
      color: #64748b;
      margin: 0;
    }

    .shipment-location {
      font-size: 12px;
      color: #64748b;
      margin: 0;
    }

    @media (max-width: 768px) {
      .nav-links {
        gap: 12px;
      }

      .nav-btn {
        font-size: 14px;
        padding: 6px 8px;
      }

      .tracking-detail {
        padding: 24px;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body>
  <div class="app-wrapper">
    <header class="header">
      <div class="header-content">
      <div class="logo-section">
        <div class="logo">
         <svg width="24" height="24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 6L12 2L20 6V14L12 18L4 14V6Z" stroke="white" stroke-width="2" stroke-linejoin="round"/> 
          <path d="M12 2V10M4 6L12 10L20 6" stroke="white" stroke-width="2" stroke-linecap="round"/>
         </svg>
        </div>
      <h1 class="company-name">Logitrack</h1>
     </div>
      <nav class="nav-links">
       <a href="home.html" class="nav-btn">Home</a>
       <a href="dashboard.html" class="nav-btn">Dashboard</a> 
       <a href="tracking.html" class="nav-btn active">Track</a> 
       <a href="help.html" class="nav-btn">Help</a>
      </nav>
    </div>
    </header>
   <main class="main-content">
    <div class="container" id="trackingView">
     <div style="text-align: center; margin-bottom: 48px;">
      <h2 style="font-size: 40px; font-weight: 800; color: #1e293b; margin-bottom: 16px;">Track Your Shipment</h2>
      <p style="font-size: 18px; color: #64748b;">Enter your tracking number to see real-time updates</p>
     </div>
     <div class="container-small">
      <div class="stat-card">
       <form id="trackingForm">
        <div class="form-group">
         <label class="form-label" for="trackingNumber">Tracking Number</label> 
         <input type="text" id="trackingNumber" class="form-input" placeholder="e.g., SH-001" required>
        </div><button type="submit" class="btn-primary">Track Shipment</button>
       </form>
      </div>
     </div>
     <div style="margin-top: 48px;">
      <h3 style="font-size: 24px; font-weight: 700; color: #1e293b; margin-bottom: 24px;">Recent Shipments</h3>
      <div class="shipments-grid" id="recentShipmentsGrid">
       <p style="text-align: center; color: #64748b; padding: 48px; grid-column: 1/-1;">Loading shipments...</p>
      </div>
     </div>
    </div>
    <div class="container" id="detailView" style="display: none;">
     <!-- Detail view will be populated by JavaScript -->
    </div>
   </main>
  </div>
  <script>
    let shipments = {};

    /* Get recently viewed shipments from localStorage */
    function getRecentlyViewed() {
      const recent = localStorage.getItem('recentlyViewedShipments');
      return recent ? JSON.parse(recent) : [];
    }

    /* Add shipment to recently viewed */
    function addToRecentlyViewed(shipmentId) {
      let recent = getRecentlyViewed();
    /* Remove if already exists */
      recent = recent.filter(id => id !== shipmentId);
      // Add to front
      recent.unshift(shipmentId);
    /* Keep only last 4 */
      recent = recent.slice(0, 4);
      localStorage.setItem('recentlyViewedShipments', JSON.stringify(recent));
    }

    /* Load shipments data from single tracking.json file */
    fetch('shipments.json')
      .then(response => response.json())
      .then(data => {
        /* Convert shipments array to object with IDs as keys */
        data.shipments.forEach(shipment => {
          shipments[shipment.id] = shipment;
        });
        
        /* Get recently viewed shipment IDs */
        const recentIds = getRecentlyViewed();
        
        /* If there are recently viewed shipments, show those */
        if (recentIds.length > 0) {
          const recentShipments = recentIds.map(id => shipments[id]).filter(s => s);
          renderRecentShipments(recentShipments);
        } else {
        /* Otherwise show first 4 shipments */
          renderRecentShipments(data.shipments.slice(0, 4));
        }
        
        /* Check URL for shipment ID after data is loaded */
        const urlParams = new URLSearchParams(window.location.search);
        const shipmentId = urlParams.get('id');
        if (shipmentId && shipments[shipmentId]) {
          addToRecentlyViewed(shipmentId);
          showShipmentDetail(shipments[shipmentId]);
        }
      })
      .catch(error => {
        console.error('Error loading tracking data:', error);
        document.getElementById('recentShipmentsGrid').innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: #ef4444; padding: 48px;">Error loading tracking data.</p>';
      });

    function renderRecentShipments(recentShipments) {
      const grid = document.getElementById('recentShipmentsGrid');
      grid.innerHTML = '';
      
      recentShipments.forEach(shipment => {
        const statusBgColor = shipment.status === 'Delivered' ? 'rgba(16, 185, 129, 0.2)' :
                              shipment.status === 'Processing' ? 'rgba(245, 158, 11, 0.2)' :
                              shipment.status === 'Delayed' ? 'rgba(239, 68, 68, 0.2)' :
                              'rgba(59, 130, 246, 0.2)';
        
        const card = document.createElement('a');
        card.href = `tracking.html?id=${shipment.id}`;
        card.className = 'shipment-card';
        card.innerHTML = `
          <div class="shipment-header">
            <div>
              <p class="shipment-id">${shipment.id}</p>
              <p class="shipment-route" style="font-weight: 500;">${shipment.route}</p>
              <p class="shipment-route" style="margin-top: 4px; font-weight: 500; color: #3c3c3c;">${shipment.transport}</p>
            </div>
            <span class="status-badge" style="background-color: ${statusBgColor}; color: ${shipment.color}; padding: 4px 12px; font-size: 12px;">
              ${shipment.status}
            </span>
          </div>
          <div class="progress-bar" style="height: 6px; margin: 12px 0;">
            <div class="progress-fill" style="width: ${shipment.progress}%; background-color: ${shipment.color};"></div>
          </div>
          <p class="shipment-location" style="font-weight: 500;">Current: ${shipment.location}</p>
        `;
        grid.appendChild(card);
      });
    }

    document.getElementById('trackingForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const trackingNumber = document.getElementById('trackingNumber').value.trim().toUpperCase();
      
      if (shipments[trackingNumber]) {
        window.location.href = 'tracking.html?id=' + trackingNumber;
      } else {
        const input = document.getElementById('trackingNumber');
        input.style.borderColor = '#ef4444';
        input.value = '';
        input.placeholder = 'Tracking number not found. Try: SH-001';
        setTimeout(() => {
          input.style.borderColor = '#e5e7eb';
          input.placeholder = 'e.g., SH-001';
        }, 3000);
      }
    });

    function generateTimeline(shipment) {
      /* Generate a dynamic timeline based on progress */
      const timeline = [];
      const parts = shipment.route.split(' → ');
      const origin = parts[0];
      const destination = parts[1];
      
      /* Step 1: Package Picked Up */
      timeline.push({
        status: 'Package Picked Up',
        location: `${origin}`,
        date: shipment.date + ' - 9:00 AM',
        completed: true
      });
      
      /* Step 2: In Transit */
      if (shipment.progress >= 20) {
        timeline.push({
          status: 'In Transit',
          location: shipment.location,
          date: shipment.date + ' - 2:30 PM',
          completed: shipment.progress >= 80
        });
      }
      
      /* Step 3: Out for Delivery */
      timeline.push({
        status: 'Out for Delivery',
        location: `${destination}`,
        date: shipment.status === 'Delivered' ? shipment.date + ' - 7:00 AM' : 'Expected Soon',
        completed: shipment.status === 'Delivered'
      });
      
      /* Step 4: Delivered */
      timeline.push({
        status: 'Delivered',
        location: `${destination}`,
        date: shipment.status === 'Delivered' ? shipment.date + ' - 3:20 PM' : 'Pending',
        completed: shipment.status === 'Delivered'
      });

      return timeline;
    }

    function showShipmentDetail(shipment) {
      document.getElementById('trackingView').style.display = 'none';
      const detailView = document.getElementById('detailView');
      detailView.style.display = 'block';
      
      const parts = shipment.route.split(' → ');
      const origin = parts[0];
      const destination = parts[1];
      const timeline = generateTimeline(shipment);
      
      detailView.innerHTML = `
        <a href="tracking.html" class="back-btn">
          <svg width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15 10H5M5 10L10 5M5 10L10 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Back to All Shipments
        </a>

        <div class="tracking-detail">
          <div style="display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap; gap: 16px; margin-bottom: 32px;">
            <div>
              <h2 style="font-size: 32px; font-weight: 800; color: #1e293b; margin: 0 0 8px 0;">Tracking: ${shipment.id}</h2>
              <p style="font-size: 18px; color: #64748b; margin: 0;">${origin} → ${destination}</p>
            </div>
            <span class="status-badge" style="background-color: ${shipment.color}20; color: ${shipment.color};">
              ${shipment.status}
            </span>
          </div>

          <div class="detail-grid">
            <div>
              <p class="detail-label">Current Location</p>
              <p class="detail-value">${shipment.location}</p>
            </div>
            <div>
              <p class="detail-label">Status</p>
              <p class="detail-value">${shipment.status}</p>
            </div>
            <div>
              <p class="detail-label">Transport</p>
              <p class="detail-value">${shipment.transport}</p>
            </div>
            <div>
              <p class="detail-label">Route</p>
              <p class="detail-value">${origin} → ${destination}</p>
            </div>
            <div>
              <p class="detail-label">Shipment Date</p>
              <p class="detail-value">${shipment.date}</p>
            </div>
          </div>

          <div class="progress-bar">
            <div class="progress-fill" style="width: ${shipment.progress}%; background-color: ${shipment.color};"></div>
          </div>
          <p style="font-size: 14px; color: #64748b; margin-top: 8px; text-align: right;">${shipment.progress}% Complete</p>

          <div class="timeline">
            <h3 style="font-size: 20px; font-weight: 700; color: #1e293b; margin-bottom: 24px;">Shipment Timeline</h3>
            ${timeline.map((event, index) => `
              <div class="timeline-item">
                <div class="timeline-dot" style="background-color: ${event.completed ? shipment.color : '#e5e7eb'}; border: 4px solid white; box-shadow: 0 0 0 2px ${event.completed ? shipment.color : '#e5e7eb'};">
                  ${event.completed ? `
                    <svg width="16" height="16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M3 8L6 11L13 4" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  ` : ''}
                </div>
                <div class="timeline-content">
                  <p class="timeline-status" style="color: ${event.completed ? '#1e293b' : '#64748b'};">${event.status}</p>
                  <p class="timeline-location">${event.location}</p>
                  <p class="timeline-date">${event.date}</p>
                </div>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }

    document.addEventListener('keydown', function(e) {
            if (e.key === 'Backspace' && !['INPUT', 'TEXTAREA'].includes(e.target.tagName)) {
              e.preventDefault();
              window.history.back();
            }
          });
  </script>
</body>
</html>